(()=>{"use strict";let e=[],t=[],o=[],c=[];localStorage.getItem("categories")&&(e=JSON.parse(localStorage.getItem("categories")),e.forEach((e=>{c.push(e.title),t.push(e.bg),0==e.cost?o.push(1):o.push(e.cost)})));const a=document.getElementById("myChart"),r=new Chart(a,{type:"doughnut",data:{labels:c,datasets:[{data:o,backgroundColor:t,borderWidth:1}]},options:{plugins:{legend:{display:!1}}}});(function(){let e=document.querySelector(".popup-category"),t=document.querySelector(".overblock"),o=document.querySelectorAll(".tools-categories__item_add"),c=document.querySelector(".popup-category__close");o.forEach((o=>{o.addEventListener("click",(function(){e.classList.add("popup-category_open"),t.classList.add("overblock_open")}))})),t.addEventListener("click",(function(){e.classList.remove("popup-category_open"),t.classList.remove("overblock_open")})),c.addEventListener("click",(function(){e.classList.remove("popup-category_open"),t.classList.remove("overblock_open")}))})(),function(e,t){let o={},c=document.querySelector(".popup-category__input"),a=document.querySelector(".popup-category__inp-bg"),r=document.querySelector(".popup-category__inp-color"),l=document.querySelectorAll(".popup-category__icon");if(localStorage.getItem("categories")){t=JSON.parse(localStorage.getItem("categories"));let d=document.querySelector(".categories__list");for(let p=0;p<JSON.parse(localStorage.getItem("categories")).length;p++){let m=`<div class="list-categories__item item-category" data-index="${JSON.parse(localStorage.getItem("categories"))[p].index}">\n                        <div class="item-category__icon ${JSON.parse(localStorage.getItem("categories"))[p].icon}" style="background-color:${JSON.parse(localStorage.getItem("categories"))[p].bg}"></div>\n                        <div class="item-category__info">\n                            <p class="item-category__name">${JSON.parse(localStorage.getItem("categories"))[p].title}</p>\n                        </div>\n                        <div class="item-category__total">0 BYN</div>\n                        </div>`;function _(e){return(new DOMParser).parseFromString(e,"text/html").querySelector(".item-category")}d.append(_(m))}}function s(e,t,o){let c=e.value,a=t.value;return e.addEventListener("input",(function(){c=e.value,o.classList.contains("act")&&(o.style.backgroundColor=c,o.style.border=`2px solid ${c}`)})),t.addEventListener("input",(function(){a=t.value,o.classList.contains("act")&&(o.style.color=a)})),[c,a]}l.forEach((e=>{e.style.backgroundColor=a.value,e.style.color=r.value})),l.forEach((e=>{e.addEventListener("click",(function(){document.querySelectorAll(".popup-category__icon").forEach((e=>{e.style.backgroundColor="#808080",e.style.color="white",e.classList.remove("act"),e.style.border="2px solid gray"})),e.classList.add("act"),e.style.border=`2px solid ${s(a,r,e)[0]}`,e.style.backgroundColor=s(a,r,e)[0],e.style.color=s(a,r,e)[1],o.icon=e.dataset.categoryIcon}))}));let i=document.querySelector(".popup-category__button"),n=document.querySelector(".popup-category"),u=document.querySelector(".overblock"),g=0;i.addEventListener("click",(function(){(function(e){let t=!0;return""==e.title&&(t=!1),e.icon||(t=!1),console.log(t),t})(o)&&(g++,localStorage.getItem("categories")&&(console.log(localStorage.getItem("categories")),g=JSON.parse(localStorage.getItem("categories"))[JSON.parse(localStorage.getItem("categories")).length-1].index,g++),function(e,t){e.index=t,e.title=c.value,e.bg=a.value,e.color=r.value,e.cost=0}(o,g),function(){let e=document.querySelector(".categories__list"),t=`<div class="list-categories__item item-category" data-index="${o.index}">\n                        <div class="item-category__icon ${o.icon}" style="background-color:${o.bg}"></div>\n                        <div class="item-category__info">\n                            <p class="item-category__name">${o.title}</p>\n                        </div>\n                        <div class="item-category__total">0 BYN</div>\n                        </div>`;e.append(function(e){return(new DOMParser).parseFromString(e,"text/html").querySelector(".item-category")}(t))}(),n.classList.remove("popup-category_open"),u.classList.remove("overblock_open"),localStorage.getItem("operations")?(t=JSON.parse(localStorage.getItem("operations"))).push(Object.assign({},o)):t.push(Object.assign({},o)),localStorage.setItem("categories",JSON.stringify(t)),localStorage.setItem("operations",JSON.stringify(t)),function(t){let o=[],c=[],a=[];t.forEach((e=>{o.push(e.title),c.push(e.bg),0==e.cost?a.push(1):a.push(e.cost)})),e.data.datasets[0].data=a,e.data.datasets[0].backgroundColor=c,e.update()}(t),setTimeout((function(){!function(e){delete e.icon,c.value="",a.value="#808080",r.value="#FFFFFF",document.querySelector(".popup-category__icon.act").style.backgroundColor="#808080",document.querySelector(".popup-category__icon.act").style.color="white",document.querySelector(".popup-category__icon.act").style.border="2px solid gray",document.querySelector(".popup-category__icon.act").classList.remove("act")}(o)}),0))}))}(r,e),function(e){let t=document.querySelector(".popup-operation"),o=document.querySelector(".overblock"),c=document.querySelector(".popup-operation__button"),a=document.querySelector(".popup-operation__input"),r=document.querySelector(".popup-operation__close");if(localStorage.getItem("operations")){let e=0;document.querySelectorAll(".list-categories__item").forEach(((t,o)=>{t.querySelector(".item-category__total").textContent=`${JSON.parse(localStorage.getItem("operations"))[o].cost} BYN`,e+=JSON.parse(localStorage.getItem("operations"))[o].cost,document.querySelector(".slider-categories__total-num").textContent=e}))}function l(){t.classList.remove("popup-operation_open"),o.classList.remove("overblock_open"),a.value=""}window.addEventListener("click",(function(e){if(e.target.closest(".list-categories__item")){document.querySelectorAll(".list-categories__item").forEach((e=>{e.classList.remove("act")}));let c=e.target.closest(".list-categories__item");c.classList.add("act"),t.classList.add("popup-operation_open"),o.classList.add("overblock_open"),function(e){let t=e.dataset.index;document.querySelectorAll(".popup-operation__body .item-category").forEach((e=>{e.style.display="none"}));let o=document.querySelector(".list-categories"),c=`<div class="item-category" data-index="${JSON.parse(localStorage.getItem("operations"))[t-1].index}">\n                    <div class="item-category__icon ${JSON.parse(localStorage.getItem("operations"))[t-1].icon}" style="background-color:${JSON.parse(localStorage.getItem("operations"))[t-1].bg}"></div>\n                    <div class="item-category__info">\n                        <p class="item-category__name">${JSON.parse(localStorage.getItem("operations"))[t-1].title}</p>\n                    </div>\n                    <div class="item-category__total">${JSON.parse(localStorage.getItem("operations"))[t-1].cost} BYN</div>\n                    </div>`;o.append(function(e){return(new DOMParser).parseFromString(e,"text/html").querySelector(".item-category")}(c))}(c)}})),c.addEventListener("click",(function(){let t=0,o=JSON.parse(localStorage.getItem("operations")),c=document.querySelector(".list-categories__item.act"),r=o[c.dataset.index-1],s=+a.value;r.cost+=s;let i=[];o.forEach((e=>{i.push(e.cost)})),o[c.dataset.index-1]=r,localStorage.setItem("operations",JSON.stringify(o)),localStorage.setItem("categories",JSON.stringify(o)),c.querySelector(".item-category__total").textContent=`${o[c.dataset.index-1].cost} BYN`,document.querySelectorAll(".list-categories__item").forEach(((e,o)=>{t+=JSON.parse(localStorage.getItem("operations"))[o].cost})),document.querySelector(".slider-categories__total-num").textContent=t,e.data.datasets[0].data=i,e.update(),l()})),o.addEventListener("click",(function(){l()})),r.addEventListener("click",(function(){l()}))}(r),function(){let e=document.querySelector(".slide-button"),t=document.querySelector(".slider-categories"),o=document.querySelector(".categories__tab_expenses"),c=document.querySelector(".categories__tab_income");e.addEventListener("click",(function(){e.classList.toggle("slide-button_active"),t.classList.toggle("slider-categories_active"),o.classList.toggle("categories__tab_active"),c.classList.toggle("categories__tab_active")}))}()})();