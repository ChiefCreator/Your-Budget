(()=>{"use strict";let e=[],t=[],o=[],a=[];localStorage.getItem("categories")&&(e=JSON.parse(localStorage.getItem("categories")),e.forEach((e=>{a.push(e.title),t.push(e.bg),0==e.cost?o.push(1):o.push(e.cost)})));const c=document.getElementById("myChart"),r=new Chart(c,{type:"doughnut",data:{labels:a,datasets:[{data:o,backgroundColor:t,borderWidth:1}]},options:{plugins:{legend:{display:!1}}}});(function(){let e=document.querySelector(".popup-category"),t=document.querySelector(".overblock"),o=document.querySelectorAll(".tools-categories__item_add"),a=document.querySelector(".popup-category__close");o.forEach((o=>{o.addEventListener("click",(function(){e.classList.add("popup-category_open"),t.classList.add("overblock_open")}))})),t.addEventListener("click",(function(){e.classList.remove("popup-category_open"),t.classList.remove("overblock_open")})),a.addEventListener("click",(function(){e.classList.remove("popup-category_open"),t.classList.remove("overblock_open")}))})(),function(e,t){let o={},a=document.querySelector(".popup-category__input"),c=document.querySelector(".popup-category__inp-bg"),r=document.querySelector(".popup-category__inp-color"),l=document.querySelectorAll(".popup-category__icon");if(localStorage.getItem("categories")){t=JSON.parse(localStorage.getItem("categories"));let g=document.querySelector(".categories__list");for(let d=0;d<JSON.parse(localStorage.getItem("categories")).length;d++){let m=`<div class="list-categories__item item-category" data-index="${JSON.parse(localStorage.getItem("categories"))[d].index}">\n                        <div class="item-category__icon ${JSON.parse(localStorage.getItem("categories"))[d].icon}" style="background-color:${JSON.parse(localStorage.getItem("categories"))[d].bg}"></div>\n                        <div class="item-category__info">\n                            <p class="item-category__name">${JSON.parse(localStorage.getItem("categories"))[d].title}</p>\n                        </div>\n                        <div class="item-category__total">0 BYN</div>\n                        </div>`;function y(e){return(new DOMParser).parseFromString(e,"text/html").querySelector(".item-category")}g.append(y(m))}}function s(e,t,o){let a=e.value,c=t.value;return e.addEventListener("input",(function(){a=e.value,o.classList.contains("act")&&(o.style.backgroundColor=a,o.style.border=`2px solid ${a}`)})),t.addEventListener("input",(function(){c=t.value,o.classList.contains("act")&&(o.style.color=c)})),[a,c]}l.forEach((e=>{e.style.backgroundColor=c.value,e.style.color=r.value})),l.forEach((e=>{e.addEventListener("click",(function(){document.querySelectorAll(".popup-category__icon").forEach((e=>{e.style.backgroundColor="#808080",e.style.color="white",e.classList.remove("act"),e.style.border="2px solid gray"})),e.classList.add("act"),e.style.border=`2px solid ${s(c,r,e)[0]}`,e.style.backgroundColor=s(c,r,e)[0],e.style.color=s(c,r,e)[1],o.icon=e.dataset.categoryIcon}))}));let i=document.querySelector(".popup-category__button"),n=document.querySelector(".popup-category"),u=document.querySelector(".overblock"),p=0;i.addEventListener("click",(function(){(function(e){let t=!0;return""==e.title&&(t=!1),e.icon||(t=!1),console.log(t),t})(o)&&(p++,localStorage.getItem("categories")&&(console.log(localStorage.getItem("categories")),p=JSON.parse(localStorage.getItem("categories"))[JSON.parse(localStorage.getItem("categories")).length-1].index,p++),function(e,t){e.index=t,e.title=a.value,e.bg=c.value,e.color=r.value,e.cost=0}(o,p),function(){let e=document.querySelector(".categories__list"),t=`<div class="list-categories__item item-category" data-index="${o.index}">\n                        <div class="item-category__icon ${o.icon}" style="background-color:${o.bg}"></div>\n                        <div class="item-category__info">\n                            <p class="item-category__name">${o.title}</p>\n                        </div>\n                        <div class="item-category__total">0 BYN</div>\n                        </div>`;e.append(function(e){return(new DOMParser).parseFromString(e,"text/html").querySelector(".item-category")}(t))}(),n.classList.remove("popup-category_open"),u.classList.remove("overblock_open"),localStorage.getItem("operations")?(t=JSON.parse(localStorage.getItem("operations"))).push(Object.assign({},o)):t.push(Object.assign({},o)),localStorage.setItem("categories",JSON.stringify(t)),localStorage.setItem("operations",JSON.stringify(t)),function(t){let o=[],a=[],c=[];t.forEach((e=>{o.push(e.title),a.push(e.bg),0==e.cost?c.push(1):c.push(e.cost)})),e.data.datasets[0].data=c,e.data.datasets[0].backgroundColor=a,e.update()}(t),setTimeout((function(){!function(e){delete e.icon,a.value="",c.value="#808080",r.value="#FFFFFF",document.querySelector(".popup-category__icon.act").style.backgroundColor="#808080",document.querySelector(".popup-category__icon.act").style.color="white",document.querySelector(".popup-category__icon.act").style.border="2px solid gray",document.querySelector(".popup-category__icon.act").classList.remove("act")}(o)}),0))}))}(r,e),function(e){let t=document.querySelector(".popup-operation"),o=document.querySelector(".overblock"),a=document.querySelector(".popup-operation__button"),c=document.querySelector(".popup-operation__input"),r=document.querySelector(".popup-operation__close");if(localStorage.getItem("operations")){let e=0;document.querySelectorAll(".list-categories__item").forEach(((t,o)=>{t.querySelector(".item-category__total").textContent=`${JSON.parse(localStorage.getItem("operations"))[o].cost} BYN`,e+=JSON.parse(localStorage.getItem("operations"))[o].cost,document.querySelector(".slider-categories__total-num").textContent=e}))}function l(){t.classList.remove("popup-operation_open"),o.classList.remove("overblock_open"),c.value=""}window.addEventListener("click",(function(e){if(e.target.closest(".list-categories__item")){document.querySelectorAll(".list-categories__item").forEach((e=>{e.classList.remove("act")}));let a=e.target.closest(".list-categories__item");a.classList.add("act"),t.classList.add("popup-operation_open"),o.classList.add("overblock_open"),function(e){let t=e.dataset.index;document.querySelectorAll(".popup-operation__body .item-category").forEach((e=>{e.style.display="none"}));let o=document.querySelector(".list-categories"),a=`<div class="item-category" data-index="${JSON.parse(localStorage.getItem("operations"))[t-1].index}">\n                    <div class="item-category__icon ${JSON.parse(localStorage.getItem("operations"))[t-1].icon}" style="background-color:${JSON.parse(localStorage.getItem("operations"))[t-1].bg}"></div>\n                    <div class="item-category__info">\n                        <p class="item-category__name">${JSON.parse(localStorage.getItem("operations"))[t-1].title}</p>\n                    </div>\n                    <div class="item-category__total">${JSON.parse(localStorage.getItem("operations"))[t-1].cost} BYN</div>\n                    </div>`;o.append(function(e){return(new DOMParser).parseFromString(e,"text/html").querySelector(".item-category")}(a))}(a)}})),a.addEventListener("click",(function(){let t=0,o=JSON.parse(localStorage.getItem("operations")),a=document.querySelector(".list-categories__item.act"),r=o[a.dataset.index-1],s=+c.value;r.cost+=s;let i=[];o.forEach((e=>{i.push(e.cost)})),o[a.dataset.index-1]=r,localStorage.setItem("operations",JSON.stringify(o)),localStorage.setItem("categories",JSON.stringify(o)),a.querySelector(".item-category__total").textContent=`${o[a.dataset.index-1].cost} BYN`,document.querySelectorAll(".list-categories__item").forEach(((e,o)=>{t+=JSON.parse(localStorage.getItem("operations"))[o].cost})),document.querySelector(".slider-categories__total-num").textContent=t,e.data.datasets[0].data=i,e.update(),l()})),o.addEventListener("click",(function(){l()})),r.addEventListener("click",(function(){l()}))}(r)})();